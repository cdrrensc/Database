\documentclass[oneside,11pt,a4paper]{article}

% PACKAGES %

\usepackage[utf8]{inputenc}    
\usepackage[T1]{fontenc}
\usepackage[francais]{babel}
\usepackage{graphicx}
\usepackage{layout}
\usepackage{color}
\usepackage{lipsum}
\usepackage{tikz}
\usepackage{lscape}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{placeins}
\usepackage{array}
\usepackage{hyperref}
\usepackage{enumerate}
%\usepackage[active,tightpage]{preview}

% Défini les marges à 2 cm
\usepackage[top=1cm, bottom=2cm, left=2.5cm, right=2.5cm]{geometry}

% Supprime l'indentation de la première ligne des paragraphes
\setlength{\parindent}{0pt}
\setlength{\parskip}{10pt}

\definecolor{keywordsColor}{rgb}{0,0.5,0}

\lstset{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize\ttfamily,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=none,                    % sets the caption-position to none
  columns=fixed,
  commentstyle=\color{green},    % comment style
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
 % frame=single,                    % adds a frame around the code
  keywordstyle=\bfseries\color{keywordsColor},       % keyword style
  language=SQL,                 % the language of the code
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=10pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{gray}, % the style that is used for the line-numbers
  morekeywords={REFERENCES},
  deletekeywords={YEAR},
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{blue},     % string literal style
  tabsize=2,                       % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}

% DOCUMENT %

\begin{document}
\title{Database project - deliverable 1}
\author{
	Arthur \bsc{Giroux}\\\small{205443}
	\and
	Colla \bsc{Rensch}\\\small{205814}
	\and
	Valentin \bsc{Matter}\\\small{203447}
}
\date{March $^{24th}$ 2013} 

\maketitle

\part*{Deliverable 1}

\section{ER model}

\begin{center}
\includegraphics[height=310px]{ermodel.jpg}
\end{center}

\noindent\hrulefill

\section{Tables creation}

\lstinputlisting{db.sql}

\noindent\hrulefill

\section{Remarks}

\begin{itemize}
	\item Athletes is the entity that stores the information of an athlete who can then participate in multiple sports or games. Which means that if an Athlete competes twice he will have only one entry in the ATHLETES table but two in the PARTICIPANTS table.
	\item Each game should at least have one event otherwise nothing happened during he games. The same applies to sports, a sport must have at least one participant, otherwise the sport never took place during any games.
	\item Countries, sports and disciplines must have a unique name as the opposite would have no sense. For games it is the pair (YEAR,TYPE) that must be unique.
	\item Due to problem with their federations some athletes may present themselves without representing a country.
	\item Some medals could not be associated to a country as some athletes aren't as for the above point.
	\item The numbers of countries, athletes and events for a given game isn't stored in the GAMES entity as they can be easily computed using some COUNT query.
	\item The names of the events, disciplines and games are not stored as they are only the concatenation of information stored in other tables.
\end{itemize}

\noindent\hrulefill

\part*{Deliverable 2}

\section*{Modifications}

We had to slightly modify our model as in forced each athlete to have a binding participant, but we noticed that there is a quite big amount of them that do not and therefor we decided to slightly change our code as to allow athletes to not have a binding participant.

\section*{Data import}

We chose to import the data using Java. We decided that any data that would generate a non-existent foreign key would be dropped was would any inconsistent incomplete data (i.e. medals without color)


Data import was made using Java. When a foreign key couldn't be found in the foreign table or when data was incomplete (medals without color, for instance), we dropped the data.

\section*{Queries}

\begin{enumerate}[A)]
	\item Simple query using multiple ANDs
	\item We have an outer-query which seeks gold medalist in sports that appear in the nested query, which computes all sports that have appeared only once
	\item We retrieve the minimum year in which each country won its first medal using a subquery and then use a simple query to get the place hosting the corresponding games.
	\item We unite (UNION) two same queries using "Summer" for one and "Winter" for the other and compute the number of medals for each country given the type (Summer or Winter), we then order them despondingly and limit the table to 1
	\item Simple GROUP BY + HAVING query
	\item We use two table of participants and two tables for countries and then just use ANDs to make find the athletes that competed for at least two countries
	\item 
	\item We simply take the COUNTRIES and use a nested query to delete all entries that do not appear in the MEDALS table
\end{enumerate}


\section*{Front-end}

Our web front-end is available at \url{http://db.tamere.ch/}. It was made using PHP and MySQL.

\end{document}